# Nemesis packet language
Язык пакетов данных Nemesis был создан для описания структуры бинарных пакетов данных с минимальным разглашением. Он позволяет определять иерархию пакетов, их поля и типы данных. Язык имеет простой и понятный синтаксис, облегчающий описание пакетов.
Он вдохновлен языками описания пакетов данных Telegram и Protobuf.

В чём Nemesis уступает другим языкам описания пакетов данных:
- Удобство: Nemesis при кодогенерации не всегда использует все возможности языка, из-за возможности злоупотребления ими при реверс-инжиниринге.
- Сырость: Nemesis является Proof of Concept, и не имеет всех возможностей других языков описания пакетов данных.

# Спецификация
Спецификация пакета данных состоит из нескольких разделов:
- Общие сведения
- Синтаксис
- Описание пакета в бинарном виде
- Возможности для усложения реверс-инжиниринга

## Общие сведения
- Файлы спецификации имеют расширение `.ns`
- Файлы спецификации пакетов данных должны быть в кодировке UTF-8

## Синтаксис
Пакет определяется с помощью ключевого слова `package`, за которым следует имя пакета и блок, заключенный в фигурные скобки `{}`:
```
package <name> {
    ...
}
```

Внутри блока пакета могут быть определены поля. Каждое поле имеет имя и тип данных, разделенные двоеточием `:` :
```
package <name> {
    <field_name>: <type>;
}
```

Типы данных могут быть примитивными или составными. Примитивные типы данных:
- `u8` - 8-битное беззнаковое целое
- `u16` - 16-битное беззнаковое целое
- `u32` - 32-битное беззнаковое целое
- `u64` - 64-битное беззнаковое целое
- `i8` - 8-битное знаковое целое
- `i16` - 16-битное знаковое целое
- `i32` - 32-битное знаковое целое
- `i64` - 64-битное знаковое целое
- `f32` - 32-битное число с плавающей точкой
- `f64` - 64-битное число с плавающей точкой
- `bool` - логическое значение
- `string` - строка

Пакеты могут наследовать другие пакеты с помощью `:'' :
```
package <name> : <parent> {
    ...
}
```

Язык поддерживает комментарии в стиле C++:
```
// Однострочный комментарий
/* Многострочный
комментарий */
```

## Описание пакета в бинарном виде
Бинарный пакет состоит из следующих частей:
- Заголовок: 4 байта. Контрольная сумма имени пакета, вычисленная с помощью алгоритма CRC32. Используется для идентификации пакета.
- Содержимое пакета: Бинарное представление полей пакета в соответствии с их типами данных и порядком объявления.

Поля пакета следуют друг за другом в том порядке, в котором они объявлены в описании пакета. Вложенные пакеты также включаются в содержимое родительского пакета.

## Возможности для усложения реверс-инжиниринга
Для усложнения реверс-инжиниринга кодогенератор не генерирует лишней информации о пакете. Вместо этого он генерирует минимальный набор методов для чтения и записи пакета, а также методы для доступа к полям пакета. 
Для большей защиты вы можете добавить обфускацию, или виртуализацию методов доступа к полям пакета.